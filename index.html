<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Escape the Upside Down</title>
<style>
  body { margin:0; background:black; color:white; text-align:center; }
  canvas { background:#111; image-rendering:pixelated; }
</style>
</head>
<body>

<h1>Escape the Upside Down</h1>
<canvas id="game" width="640" height="480"></canvas>
<script>

const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// load sprites
let playerImg = new Image();
playerImg.src = "player.png"; // 8bit sprite sheet

let tileImg = new Image();
tileImg.src = "tiles.png"; // your tile sheet

let goalImg = new Image();
goalImg.src = "goal.png";

// map grid
const map = [
  [1,1,1,1,1,1,1,1,1,1],
  [1,0,0,0,0,0,0,0,0,1],
  [1,0,0,2,0,0,0,0,0,1],
  [1,0,0,0,0,0,0,0,0,1],
  [1,0,0,0,0,0,0,0,0,1],
  [1,0,0,0,0,0,0,0,3,1],
  [1,1,1,1,1,1,1,1,1,1]
];

const TILE_SIZE = 48;

let player = {
  x: TILE_SIZE*1,
  y: TILE_SIZE*1,
  frame: 0,
  w: TILE_SIZE,
  h: TILE_SIZE
};

let keys = {};

// controls
window.addEventListener("keydown", (e) => keys[e.key.toLowerCase()] = true);
window.addEventListener("keyup", (e) => keys[e.key.toLowerCase()] = false);

function update() {
  // movement
  if (keys["w"]) player.y -= 2;
  if (keys["s"]) player.y += 2;
  if (keys["a"]) player.x -= 2;
  if (keys["d"]) player.x += 2;

  // simple goal collision
  let gx = TILE_SIZE*8;
  let gy = TILE_SIZE*5;
  if (Math.abs(player.x - gx) < 10 && Math.abs(player.y - gy) < 10) {
    alert("You Escaped! ðŸŽ‰");
    window.location.reload();
  }
}

function draw() {
  // draw map
  for (let r=0;r<map.length;r++) {
    for (let c=0;c<map[r].length;c++) {
      let tile = map[r][c];
      if (tile === 1) ctx.fillStyle = "#333";
      else ctx.fillStyle = "#222";
      ctx.fillRect(c*TILE_SIZE, r*TILE_SIZE, TILE_SIZE, TILE_SIZE);
    }
  }

  // draw goal
  ctx.drawImage(goalImg, TILE_SIZE*8, TILE_SIZE*5, TILE_SIZE, TILE_SIZE);

  // draw player
  ctx.drawImage(playerImg,
    player.frame*TILE_SIZE, 0, TILE_SIZE, TILE_SIZE,
    player.x, player.y, TILE_SIZE, TILE_SIZE);

  // update animation
  player.frame = (player.frame + 1) % 4;
}

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

loop();

</script>
</body>
</html>
